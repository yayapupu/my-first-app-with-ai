<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å™—å™— Binance äº‹ä»¶åˆç´„é æ¸¬å™¨</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/technicalindicators@3.1.0/dist/browser.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    #result {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
    }
    #details {
      margin-top: 10px;
      background-color: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>å™—å™— Binance äº‹ä»¶åˆç´„é æ¸¬å™¨ (10/30åˆ†é˜)</h1>
  <label for="symbol">é¸æ“‡å¹£ç¨®:</label>
  <select id="symbol">
    <option value="BTCUSDT">æ¯”ç‰¹å¹£ (BTC)</option>
    <option value="ETHUSDT">ä»¥å¤ªå¹£ (ETH)</option>
  </select>

  <label for="interval">æ™‚é–“å°ºåº¦:</label>
  <select id="interval">
    <option value="10m">10åˆ†é˜</option>
    <option value="30m">30åˆ†é˜</option>
  </select>

  <button onclick="analyzeMarket()">åˆ†æ</button>
  <div id="result"></div>
  <div id="details"></div>

  <script>
    async function analyzeMarket() {
      const symbol = document.getElementById("symbol").value;
      const interval = document.getElementById("interval").value;
      const limit = interval === "10m" ? 50 : 100;

      const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1m&limit=${limit}`);
      const data = await response.json();

      const closePrices = data.map(d => parseFloat(d[4]));
      const highPrices = data.map(d => parseFloat(d[2]));
      const lowPrices = data.map(d => parseFloat(d[3]));

      const macd = window.technicalindicators.MACD.calculate({
        values: closePrices,
        fastPeriod: 12,
        slowPeriod: 26,
        signalPeriod: 9,
        SimpleMAOscillator: false,
        SimpleMASignal: false
      });

      const latestMACD = macd[macd.length - 1];
      let macdSignal = "";
      if (latestMACD.MACD > latestMACD.signal) macdSignal = "çœ‹æ¼²";
      else if (latestMACD.MACD < latestMACD.signal) macdSignal = "çœ‹è·Œ";
      else macdSignal = "ç›¤æ•´";

      const rsi = window.technicalindicators.RSI.calculate({
        values: closePrices,
        period: 14
      });
      const latestRSI = rsi[rsi.length - 1];
      let rsiSignal = latestRSI > 70 ? "éç†± (çœ‹è·Œ)" : latestRSI < 30 ? "è¶…è³£ (çœ‹æ¼²)" : "ä¸­æ€§";

      const kdj = window.technicalindicators.Stochastic.calculate({
        high: highPrices,
        low: lowPrices,
        close: closePrices,
        period: 14,
        signalPeriod: 3
      });
      const latestKDJ = kdj[kdj.length - 1];
      let kdjSignal = latestKDJ.k > latestKDJ.d ? "çœ‹æ¼²" : latestKDJ.k < latestKDJ.d ? "çœ‹è·Œ" : "ä¸­æ€§";

      const bb = window.technicalindicators.BollingerBands.calculate({
        period: 20,
        values: closePrices,
        stdDev: 2
      });
      const latestBB = bb[bb.length - 1];
      const lastPrice = closePrices[closePrices.length - 1];
      let bbSignal = "ä¸­æ€§";
      if (lastPrice >= latestBB.upper) bbSignal = "åƒ¹æ ¼è§¸åŠä¸Šè»Œ â†’ çœ‹è·Œ";
      else if (lastPrice <= latestBB.lower) bbSignal = "åƒ¹æ ¼è§¸åŠä¸‹è»Œ â†’ çœ‹æ¼²";
      else bbSignal = "ä¸­è»Œé™„è¿‘ â†’ ç›¤æ•´";

      const now = new Date().toLocaleString();

      // ç¶œåˆåˆ†æ
      let bullish = 0, bearish = 0;
      if (macdSignal === "çœ‹æ¼²") bullish++; else if (macdSignal === "çœ‹è·Œ") bearish++;
      if (rsiSignal.includes("çœ‹æ¼²")) bullish++; else if (rsiSignal.includes("çœ‹è·Œ")) bearish++;
      if (kdjSignal === "çœ‹æ¼²") bullish++; else if (kdjSignal === "çœ‹è·Œ") bearish++;
      if (bbSignal.includes("çœ‹æ¼²")) bullish++; else if (bbSignal.includes("çœ‹è·Œ")) bearish++;

      let conclusion = "ç›¤æ•´ä¸­ï¼Œä¸å®œå…¥å ´ ğŸš«";
      if (bullish >= 3) conclusion = `é æ¸¬ ${interval} å¾Œåƒ¹æ ¼å°‡ä¸Šæ¼² ğŸ“ˆ`;
      else if (bearish >= 3) conclusion = `é æ¸¬ ${interval} å¾Œåƒ¹æ ¼å°‡ä¸‹è·Œ ğŸ“‰`;

      document.getElementById("result").textContent = `åˆ†æçµæœï¼š${conclusion}`;
      document.getElementById("details").textContent = `åˆ†ææ™‚é–“ï¼š${now}\n` +
        `â†’ MACDï¼š${macdSignal} (å€¼ï¼š${latestMACD.MACD.toFixed(3)} / è¨Šè™Ÿï¼š${latestMACD.signal.toFixed(3)})\n` +
        `â†’ RSIï¼š${rsiSignal} (å€¼ï¼š${latestRSI.toFixed(2)})\n` +
        `â†’ KDJï¼š${kdjSignal} (K=${latestKDJ.k.toFixed(2)} / D=${latestKDJ.d.toFixed(2)})\n` +
        `â†’ å¸ƒæ—é€šé“ï¼š${bbSignal} (åƒ¹æ ¼=${lastPrice.toFixed(2)}, ä¸Š=${latestBB.upper.toFixed(2)}, ä¸‹=${latestBB.lower.toFixed(2)})`;
    }
  </script>
</body>
</html>
