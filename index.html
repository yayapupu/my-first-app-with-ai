<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å™—å™— Binance äº‹ä»¶åˆç´„é æ¸¬å™¨</title>
  <script src="https://cdn.jsdelivr.net/npm/technicalindicators@3.1.0/dist/browser.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }
    select, button {
      margin: 10px;
      padding: 5px;
    }
    #result, #details {
      margin-top: 20px;
      padding: 10px;
      border-radius: 6px;
      background: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #details {
      white-space: pre-wrap;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>å™—å™— Binance äº‹ä»¶åˆç´„é æ¸¬å™¨ (10/30åˆ†é˜)</h1>
  <label for="symbol">é¸æ“‡å¹£ç¨®:</label>
  <select id="symbol">
    <option value="BTCUSDT">æ¯”ç‰¹å¹£ (BTC)</option>
    <option value="ETHUSDT">ä»¥å¤ªå¹£ (ETH)</option>
  </select>

  <label for="interval">æ™‚é–“å°ºåº¦:</label>
  <select id="interval">
    <option value="10m">10åˆ†é˜</option>
    <option value="30m">30åˆ†é˜</option>
  </select>

  <button onclick="analyzeMarket()">åˆ†æ</button>

  <div id="result"></div>
  <div id="details"></div>

  <script>
    async function analyzeMarket() {
      const symbol = document.getElementById("symbol").value;
      const interval = document.getElementById("interval").value;
      const limit = interval === "10m" ? 50 : 100;

      const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1m&limit=${limit}`);
      const data = await res.json();

      const close = data.map(c => parseFloat(c[4]));
      const high = data.map(c => parseFloat(c[2]));
      const low = data.map(c => parseFloat(c[3]));

      const time = new Date().toLocaleString();

      // MACD
      const macd = window.technicalindicators.MACD.calculate({
        values: close,
        fastPeriod: 12,
        slowPeriod: 26,
        signalPeriod: 9,
        SimpleMAOscillator: false,
        SimpleMASignal: false
      });
      const latestMACD = macd[macd.length - 1];
      const macdSignal = latestMACD.MACD > latestMACD.signal ? "çœ‹æ¼²" : latestMACD.MACD < latestMACD.signal ? "çœ‹è·Œ" : "ç›¤æ•´";

      // RSI
      const rsi = window.technicalindicators.RSI.calculate({ values: close, period: 14 });
      const latestRSI = rsi[rsi.length - 1];
      const rsiSignal = latestRSI > 70 ? "çœ‹è·Œ" : latestRSI < 30 ? "çœ‹æ¼²" : "ç›¤æ•´";

      // KDJ (Stochastic)
      const kdj = window.technicalindicators.Stochastic.calculate({
        high,
        low,
        close,
        period: 14,
        signalPeriod: 3
      });
      const latestKDJ = kdj[kdj.length - 1];
      const kdjSignal = latestKDJ.k > latestKDJ.d ? "çœ‹æ¼²" : latestKDJ.k < latestKDJ.d ? "çœ‹è·Œ" : "ç›¤æ•´";

      // Bollinger Bands
      const bb = window.technicalindicators.BollingerBands.calculate({
        values: close,
        period: 20,
        stdDev: 2
      });
      const latestBB = bb[bb.length - 1];
      const lastPrice = close[close.length - 1];
      let bbSignal = "ç›¤æ•´";
      if (lastPrice >= latestBB.upper) bbSignal = "çœ‹è·Œ";
      else if (lastPrice <= latestBB.lower) bbSignal = "çœ‹æ¼²";

      // çµ±åˆåˆ†æ
      let bullish = 0, bearish = 0;
      if (macdSignal === "çœ‹æ¼²") bullish++; else if (macdSignal === "çœ‹è·Œ") bearish++;
      if (rsiSignal === "çœ‹æ¼²") bullish++; else if (rsiSignal === "çœ‹è·Œ") bearish++;
      if (kdjSignal === "çœ‹æ¼²") bullish++; else if (kdjSignal === "çœ‹è·Œ") bearish++;
      if (bbSignal === "çœ‹æ¼²") bullish++; else if (bbSignal === "çœ‹è·Œ") bearish++;

      let final = "ç›¤æ•´ä¸­ï¼Œä¸å®œå…¥å ´ ğŸš«";
      if (bullish >= 3) final = `é æ¸¬ ${interval} å¾Œ ${symbol} å°‡ä¸Šæ¼² ğŸ“ˆ`;
      else if (bearish >= 3) final = `é æ¸¬ ${interval} å¾Œ ${symbol} å°‡ä¸‹è·Œ ğŸ“‰`;

      document.getElementById("result").innerText = `åˆ†æçµæœï¼š${final}`;

      document.getElementById("details").innerText =
        `åˆ†ææ™‚é–“ï¼š${time}\n` +
        `â†’ MACD (${macdSignal}): MACD=${latestMACD.MACD.toFixed(3)}, signal=${latestMACD.signal.toFixed(3)}\n` +
        `â†’ RSI (${rsiSignal}): RSI=${latestRSI.toFixed(2)}\n` +
        `â†’ KDJ (${kdjSignal}): K=${latestKDJ.k.toFixed(2)}, D=${latestKDJ.d.toFixed(2)}\n` +
        `â†’ å¸ƒæ—é€šé“ (${bbSignal}): åƒ¹æ ¼=${lastPrice.toFixed(2)}, ä¸Š=${latestBB.upper.toFixed(2)}, ä¸‹=${latestBB.lower.toFixed(2)}`;
    }
  </script>
</body>
</html>
